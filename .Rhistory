install.packages("MASS")
names(birthwt)
names(birthwt)
install.packages("MASS")
install.packages("MASS")
names(birthwt)
names(bwt)
install.packages(MASS)
install.packages("MASS")
install.packages("MASS")
names(birthwt)
names(birthwt)
help(birthwt,package="MASS")
data(birthwt,package=”MASS”)
birthwt
help(data)
data(birthwt,package=MASS)
data(birthwt,package='MASS')
names(birthwt)
birthwt$smoke
subset(birthwt,smoke=1)
Y=subset(birthwt,smoke=0)
Y$smoke
delete(Y)
Y=subset(birthwt,smoke==0)
Y$smoke
X=subset(birthwt,smoke==1)
var.test(X,Y,ratio=1,alterantive='two_sided',conf.level=0.95)
var.test(X$bwt,Y$bwt,ratio=1,alterantive='two_sided',conf.level=0.95)
help(t.test)
t.test(X$bwt,Y$bwt,alternative='two_sided',conf.level=0.95)
t.test(X$bwt,Y$bwt,var.equal=F)
library(ROCR)
?ROC
######Projet final STA203 - Apprentissage supervisé########
###########################################################
# Nom1 = Limes
# Nom2 = Perdrix
rm(list=objects()); graphics.off()
setwd("C:/Users/lucie/OneDrive/Documents/Documents/ENSTA/2A/STA203/PROJETSTA203")
#Package
library(ggplot2)
library(GGally)
library(corrplot)
library(caret)
library(glmnet)
df=read.table("Music_2023.txt",dec='.',header=TRUE,sep=';')
grid = 10^seq(10,-2,length=100)
x = as.matrix(df[,-192])
y = as.numeric(factor(df$GENRE))-1
ridge.fit = glmnet(x,y,alpha=0,lambda=grid)
plot(ridge.fit)
################
### Q3
################
set.seed(314)
n=nrow(df)
train=sample(c(TRUE,FALSE),n,rep=TRUE,prob=c(2/3,1/3))
CV=cv.glmnet(x,y,alpha=0,lambda=grid,nfolds=10)
lambda=CV$lambda.min #0.01
y.test = y[train==FALSE]
Mod=glmnet(x[train==TRUE,],y[train==TRUE],alpha=0,lambda=grid)
#Calcul de l'erreur de prédiction
ridge.pred = predict(Mod,s=lambda,newx=x[train==FALSE,])
glm.pred = ifelse(ridge.pred>0.5,1,0)
mean(glm.pred!=y.test)   #0.09652236
mean((glm.pred-y.test)^2) #0.09652236
test=read.table("Music_2023_test.txt",dec='.',header=TRUE,sep=';')
setwd("C:/Users/lucie/OneDrive/Documents/Documents/ENSTA/2A/STA203/PROJETSTA203")
test=read.table("Music_test.txt",dec='.',header=TRUE,sep=';')
x=as.matrix[test]
x=as.matrix(test)
pred=predict(Mod,s=lambda,newx=x)
pred=ifelse(pred>0.5,1,0)
df=read.table("Music_2023.txt",dec='.',header=TRUE,sep=';')
df$GENRE
as.numeric(factor(df$GENRE))-1
pred=ifelse(pred==1,"Jazz","Classical")
pred
write.table(pred,"LIMES-PERDRIX_test.txt")
write.table(pred,"LIMES-PERDRIX_test.txt",sep="\t")
